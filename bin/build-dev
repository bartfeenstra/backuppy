#!/usr/bin/env bash

set -e

cd `dirname "$0"`/..

# Set up wait-for-it.
if [ ! -f ./bin/wait-for-it ]; then
    curl https://raw.githubusercontent.com/vishnubob/wait-for-it/master/wait-for-it.sh > ./bin/wait-for-it
    chmod ugo+rx ./bin/wait-for-it
fi

# Build the SSH location container used for testing.
CONTAINER_NAME=backuppy_ssh_location
docker image rm $CONTAINER_NAME || true
docker build -t $CONTAINER_NAME ./backuppy/tests/resources/container

pip install -e .
pip install -r requirements-dev.txt
